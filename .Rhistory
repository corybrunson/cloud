### Subset data
# RESTRICT AT EACH STEP TO JOURNALS APPEARING EACH YEAR
# set working directory
if(file.exists('~/Documents')) {
setwd('~/Documents/CQM/PubMed')
} else {
setwd('~/PubMed')
}
# source base code & choices
source("proj/coauthorship/code/base.R")
source("proj/coauthorship/code/choices.R")
load("proj/coauthorship/calc/merDat.RData")
head(merDat)
rm(list=ls())
?abline
setwd("~/Documents/CQM/Derya/pkg/cloud")
devel = TRUE
if (devel) {
library(devtools)
load_all()
} else {
library(cloud)
}
library(knitr)
opts_chunk$set(echo=FALSE, results=FALSE, message=FALSE, warning=FALSE)
data(Target)
print(Target)
print(class(Target))
T_freq <- rep(1 / nrow(Target), ncol(Target))
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
text(Target, labels = rownames(Target), pos = 1)
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
legend(x = -19, y = 19, box.lty = 0, legend = "Target example")
G <- barycenter(Target)
print(G)
# Vectors from barycenter to each point
T_vectors <- Target - do.call(rbind,
replicate(nrow(Target),
G,
simplify = FALSE))
# Plot barycenter and vectors therefrom to points in cloud
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
x = c(), y = c(),
xlab = "", ylab = "")
text(G, labels = "G", adj = c(1.5, 1.25))
for (i in 1:nrow(Target)) {
text(Target[i, , drop = FALSE], labels = rownames(Target)[i],
adj = .5 - (T_vectors[i, ] / sqrt(sum(T_vectors[i, ] ^ 2))))
}
arrows(x0 = G[, 1], y0 = G[, 2],
x1 = Target[, 1], y1 = Target[, 2],
length = .15, angle = 15)
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
legend(x = -19, y = 19, box.lty = 0,
legend = "Target: barycentric characterization")
P <- c(0, 0)
P_in <- inertia(point = P, cloud = Target)
G_in <- inertia(point = G, cloud = Target)
T_var <- inertia(G, cloud = Target,
weights = T_freq)
print(c(center_inertia = P_in,
barycenter_inertia = G_in,
variance = T_var))
Ctas <- T_freq * apply(Target, 1, function(m) {
sum((m - G) ^ 2)
})
Ctrs <- Ctas / T_var
print(cbind(Ctas, Ctrs))
# Three plots!
par(mfrow = c(1, 3))
# Plot points relative to center
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
segments(x0 = 0, y0 = 0, x1 = Target[, 1], y1 = Target[, 2])
text(x = P[1], y = P[2], labels = "P",
adj = c(sqrt(2), sqrt(2)))
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
# Plot center relative to barycenter
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
x = c(), y = c(),
xlab = "", ylab = "")
points(rbind(P, G),
pch = c(13, 21), bg = c("white", "grey"), cex = 2)
segments(x0 = P[1], y0 = P[2],
x1 = G[1], y1 = G[2])
text(x = rbind(P, G),
labels = c("P", "G"), adj = c(1, -1))
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
# Plot points relative to barycenter
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
segments(x0 = G[1], y0 = G[2],
x1 = Target[, 1], y1 = Target[, 2])
text(x = G[1], y = G[2], labels = "G",
adj = c(sqrt(3), 1))
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
# Reset
par(mfrow = c(1, 1))
axis <- rbind(c(0, 0), c(2, 1))
axis_var <- direction.variance(cloud = Target, weights = T_freq,
subspace = axis)
print(axis_var)
# Plot cloud and axis
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
m <- diff(axis[, 2], axis[, 1])
abline(a = axis[2, 1] - m * axis[1, 1], b = m, lty = 2)
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
m <- diff(axis[, 2]) / diff(axis[, 1])
m
abline(a = axis[2, 1] - m * axis[1, 1], b = m, lty = 2)
points(P, pch = 13, cex = 2)
points(x = P, pch = 13, cex = 2)
points(x = P[1], y = P[2], pch = 13, cex = 2)
P
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
points(x = P[1], y = P[2], pch = 13, cex = 2)
m <- diff(axis[, 2]) / diff(axis[, 1])
abline(a = axis[2, 1] - m * axis[1, 1], b = m, lty = 2)
points(x=0,y=0)
axis
abline(a = axis[1, 2] - m * axis[1, 1], b = m, lty = 2)
# Plot cloud and axis
plot(xlim = c(-19, 19), ylim = c(-19, 19), axes = FALSE, asp = 1,
Target, pch = 16,
xlab = "", ylab = "")
points(x = P[1], y = P[2], pch = 13, cex = 2)
m <- diff(axis[, 2]) / diff(axis[, 1])
abline(a = axis[1, 2] - m * axis[1, 1], b = m, lty = 2)
rect(xleft = -19, xright = 19, ybottom = -19, ytop = 19, lty = 3)
